<dom-module id="app-list">
  <style>
    :host {
      display: block;
    }
  </style>
  <template>
    <ul>
      <template is="dom-repeat" items="{{items}}">
        <li><span class="paper-font-body1">{{item}}</span></li>
      </template>
    </ul>
    <paper-button on-click="refresh_me">refresh</paper-button>
    <iron-ajax id="my_iron" url="/applications" handle-as="json" on-response="handleResponse"></iron-ajax>
    <ul>
      <template is="dom-repeat" items="{{onlineItems}}">
        <li on-click="open_me">
          <span class="paper-font-body1">{{item.id}}</span>
          <span class="paper-font-body1">{{item.company_link}}</span>
          <span class="paper-font-body1">{{item.followup}}</span>
        </li>
      </template>
    </ul>

    <a id="item-link" href="javascript:;"><span>{{item.id}}</span></a>


  </template>
</dom-module>
<script>
  (function () {
    Polymer({
      is: 'app-list',
      properties: {
        onlineItems: {
          type: Array,
          notify: true,
        }
      },

      ready: function() {
        console.log('app-list. I am ready');
        this.$.my_iron.generateRequest();
      },
      refresh_me:function(){
        this.$.my_iron.generateRequest();
      },
      open_me: function(e) {
        var model = e.model;
        var id = model.item.id;
        console.log('the id is', id);
        window.location = '#!/apps/' + String(id);
        window.location.reload();
        //model.set('item.ordered', model.item.ordered+1);
      },
      handleResponse:function(response){
        console.log(response.detail.response);
        this.onlineItems = response.detail.response;
      }
    });
  })();
</script>
